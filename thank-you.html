<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙ‚Ø¯ÙŠÙ…Ùƒ | ROYAL CORE</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  html,body{margin:0;padding:0;height:100%;font-family:'Cairo',sans-serif;background:#0a1e4d;color:#facc15}
  .glass{backdrop-filter:blur(30px) saturate(180%);background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.25);border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,.4)}
  .btn{background:linear-gradient(90deg,#facc15,#30e0b0);color:#0a1e4d;padding:.75rem 1.2rem;border-radius:14px;font-weight:900;box-shadow:0 0 24px #facc15aa}
</style>
</head>
<body>
<main class="p-6 max-w-3xl mx-auto">
  <section class="glass p-8 my-8 text-center">
    <h1 class="text-3xl md:text-4xl font-extrabold mb-2">Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙ‚Ø¯ÙŠÙ…Ùƒ ğŸ™Œ</h1>
    <p class="text-white/90">ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù…Ù†Ø§. ÙŠÙ…ÙƒÙ†Ùƒ Ø­ÙØ¸ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© ÙˆÙ…Ø±Ø§Ø¬Ø¹Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª.</p>
  </section>

  <section id="card" class="glass p-6 rounded-2xl">
    <div class="flex items-center justify-between flex-wrap gap-3 mb-3">
      <div class="bg-[#facc15] text-[#0a1e4d] font-bold rounded-full px-3 py-1">ğŸªª Client Card</div>
      <div id="cc-updated" class="text-white/80 text-sm">â€”</div>
    </div>
    <div class="grid md:grid-cols-2 gap-5">
      <div>
        <div id="cc-name" class="text-2xl font-extrabold text-white">â€”</div>
        <div id="cc-case" class="text-white/80 mt-1">ğŸ†” â€”</div>
        <div id="cc-status" class="text-white/80 mt-1">ğŸ“Š Submitted</div>
      </div>
      <div class="text-white/90">
        <div id="cc-contact">ğŸ“§ â€” | ğŸ“± â€”</div>
        <div id="cc-location" class="mt-1">ğŸ“ â€”</div>
      </div>
    </div>
    <div class="flex gap-3 mt-4">
      <a id="cc-edit" class="btn flex-1 text-center" target="_blank" rel="noopener">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</a>
      <button id="cc-copy" class="btn flex-1">ğŸ”— Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</button>
    </div>
  </section>

  <section class="glass p-6 rounded-2xl mt-4">
    <h3 class="font-bold mb-2">Ù…Ø§ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©ØŸ</h3>
    <ul class="text-white/90 list-disc pr-6 space-y-1">
      <li>Ø§Ø­ØªÙØ¸ Ø¨Ø±Ù‚Ù… Ø§Ù„Ù‚Ø¶ÙŠØ© Ù„Ø¯ÙŠÙƒ â€” Ø³ØªØ­ØªØ§Ø¬Ù‡ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±.</li>
      <li>Ø±Ø§Ø¬Ø¹ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆØ±Ø³Ø§Ø¦Ù„ Ù‡Ø§ØªÙÙƒ Ù„Ø£ÙŠ ØªØ­Ø¯ÙŠØ«Ø§Øª Ø£Ùˆ Ø·Ù„Ø¨ Ù…Ø³ØªÙ†Ø¯Ø§Øª.</li>
      <li>ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª.</li>
    </ul>
  </section>
</main>

<script>
const webAppUrl = 'https://script.google.com/macros/s/AKfycbwV5_K8M5HZtOCsL2LnY2LVzgYbWsJcvgRdiI82bxc2-9NGYGd-yYKXTtvuou66_5Lv/exec';

function p(k){ return new URLSearchParams(location.search).get(k) || ''; }

function render(d){
  const caseNo = d.caseNumber || d.caseId || p('uniqueId') || 'â€”';
  const fullName = d.fullName || p('fullName4') || 'â€”';
  const email = d.email || p('email5') || 'â€”';
  const phone = d.phone || p('input45') || 'â€”';
  const city = (d.address && d.address.city) || p('city') || 'â€”';
  const st = d.applicationStatus || p('applicationStatus') || 'Submitted';
  const updated = (d.meta && d.meta.lastUpdateDate) || new Date().toLocaleString();

  document.getElementById('cc-name').textContent = fullName;
  document.getElementById('cc-case').textContent = 'ğŸ†” ' + caseNo;
  document.getElementById('cc-status').textContent = 'ğŸ“Š ' + st;
  document.getElementById('cc-contact').textContent = `ğŸ“§ ${email} | ğŸ“± ${phone}`;
  document.getElementById('cc-location').textContent = `ğŸ“ ${city}`;
  document.getElementById('cc-updated').textContent = updated;

  const submissionID = (d.meta && d.meta.submissionID) || p('submissionID') || '';
  const editUrl = (d.meta && d.meta.editUrl) || p('edit_link') || (submissionID ? `https://www.jotform.com/edit/${submissionID}` : '#');
  document.getElementById('cc-edit').href = editUrl;

  document.getElementById('cc-copy').onclick = ()=>{
    const url = `${location.origin}${location.pathname}?submissionID=${encodeURIComponent(submissionID)}&uniqueId=${encodeURIComponent(caseNo)}#card`;
    navigator.clipboard.writeText(url);
    alert('ØªÙ… Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©');
  };
}

(async function init(){
  // Instant render from URL tokens
  render({});

  // Enrich from backend using submissionID if present
  const sid = p('submissionID');
  if (sid) {
    try{
      const url = `${webAppUrl}?action=track&by=submission&key=${encodeURIComponent(sid)}`;
      const r = await fetch(url, {cache:'no-store'});
      if (r.ok){
        const d = await r.json();
        if (d && Object.keys(d).length) render(d);
      }
    }catch(_){}
  }
})();
</script>
</body>
</html>
