<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>تم استلام طلبك - بوابة التوظيف</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet" />
<style>
  :root{
    --bg1:#0a1440; --bg2:#0e1b55; --bg3:#132a78;
    --glass: rgba(255,255,255,.06);
    --stroke: rgba(255,255,255,.18);
    --gold:#ffd700; --gold2:#ffe68a;
    --cyan:#30e0b0; --lav:#bfa8ff;
    --text:#f7f9ff; --muted:#cfd3ff;
    --glow: 0 0 48px rgba(191,168,255,.25), 0 0 24px rgba(255,215,0,.18);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:'Cairo', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text);
    background:
      radial-gradient(1200px 800px at 12% 8%, #27408955, transparent 60%),
      radial-gradient(900px 700px at 88% 90%, #12204f55, transparent 55%),
      linear-gradient(135deg, var(--bg1), var(--bg2) 40%, var(--bg3));
    display:flex; align-items:center; justify-content:center; padding:24px;
    overflow-x:hidden;
  }

  /* animated blue/gold scene (CSS only) */
  .scene{position:fixed; inset:0; z-index:-2; overflow:hidden; pointer-events:none; filter:saturate(1.05)}
  .orb,.ring,.chip{position:absolute; opacity:.6; mix-blend-mode:screen; will-change:transform,opacity}
  .orb{ width:440px; height:440px; border-radius:50%;
        background:radial-gradient(circle at 30% 30%, #8c7cff, transparent 60%),
                   radial-gradient(circle at 70% 70%, #ffe27a, transparent 65%);
        box-shadow:0 0 80px #8c7cff33, 0 0 60px #ffe27a22; animation: float 18s ease-in-out infinite;}
  .orb.o1{ top:-140px; left:-140px; animation-delay:-2s}
  .orb.o2{ bottom:-160px; right:-180px; transform:scale(.85); animation-delay:-7s}
  .ring{ width:720px; height:720px; border-radius:50%; border:1px dashed rgba(255,255,255,.14);
         box-shadow:inset 0 0 90px #ffffff10; top:-240px; right:-200px; animation: spin 30s linear infinite}
  .chip{ width:200px; height:200px; border-radius:24px;
         background:linear-gradient(135deg, #89a4ff22, #ffe27a17);
         border:1px solid rgba(255,255,255,.12); top:18%; left:8%;
         transform:rotate(8deg); animation: float 20s ease-in-out infinite reverse;}
  @keyframes float{0%,100%{transform:translateY(0) translateX(0)}50%{transform:translateY(-14px) translateX(8px)}}
  @keyframes spin{to{transform:rotate(360deg)}}

  .wrap{ width:min(980px, 96vw) }
  .card{
    background:var(--glass); border:1px solid var(--stroke);
    border-radius:24px; padding:28px; position:relative; overflow:hidden;
    backdrop-filter: blur(14px);
    box-shadow: 0 12px 40px rgba(0,0,0,.35), inset 0 0 32px rgba(255,255,255,.05);
  }
  .card::before{
    content:""; position:absolute; inset:-2px; border-radius:26px; z-index:-1; opacity:.44;
    background: conic-gradient(from 220deg at 50% 50%, var(--lav), var(--gold), var(--lav));
    filter: blur(10px);
  }
  .edge{position:absolute; inset:1px; border-radius:22px; pointer-events:none;
    background:linear-gradient(180deg, #ffffff10, transparent); box-shadow:inset 0 0 60px #ffffff10;}

  .header{text-align:center}
  .logo{max-width:120px; filter:drop-shadow(0 2px 8px rgba(0,0,0,.45))}
  .title{margin:10px 0 2px; font-weight:800; color:var(--gold);
         font-size:clamp(22px, 2.6vw, 30px); letter-spacing:.2px}
  .subtitle{margin:0; color:var(--lav); font-size:clamp(14px, 1.8vw, 18px)}
  .lead{margin:10px auto 0; max-width:760px; color:var(--muted); line-height:1.8; text-wrap:balance}

  .status,.case{ text-align:center; margin:18px 0 6px; font-weight:800; color:var(--lav);
                 font-size:clamp(15px, 2vw, 19px)}
  .pill{
    display:inline-block; padding:.35rem .8rem; border-radius:999px; font-weight:800;
    background:linear-gradient(45deg, #ffffff10, #ffffff05);
    border:1px solid rgba(255,255,255,.22); color:#fff; box-shadow: var(--glow);
  }

  .grid{
    display:grid; gap:10px; margin-top:16px; grid-template-columns: 1fr 2fr;
    background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.12);
    border-radius:16px; overflow:hidden;
  }
  .row{display:contents}
  .label{padding:12px 14px; font-weight:800; color:var(--gold);
         border-bottom:1px solid rgba(255,255,255,.06);
         background:linear-gradient(90deg, rgba(255,255,255,.04), transparent)}
  .value{padding:12px 14px; border-bottom:1px solid rgba(255,255,255,.06)}

  .actions{ display:flex; flex-wrap:wrap; gap:12px; justify-content:center; margin-top:18px }
  .btn{
    appearance:none; border:none; cursor:pointer; text-decoration:none; outline:none;
    padding:12px 16px; border-radius:14px; font-weight:900; letter-spacing:.25px; font-size:16px;
    color:#0e1333; background:linear-gradient(45deg, var(--gold), var(--gold2));
    box-shadow:0 10px 26px rgba(255,215,0,.28);
    transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
    display:inline-flex; align-items:center; gap:10px
  }
  .btn.alt{ color:#fff; background:linear-gradient(45deg, #8f7eff, #beaaff);
            box-shadow:0 10px 26px rgba(190,170,255,.28)}
  .btn.ghost{ color:#fff; background:transparent; border:1px solid rgba(255,255,255,.28)}
  .btn:hover{ transform:translateY(-2px); box-shadow:0 12px 30px rgba(255,215,0,.36) }
  .btn.alt:hover{ box-shadow:0 12px 30px rgba(190,170,255,.36) }
  .btn.ghost:hover{ filter:brightness(1.12) }

  .footer{ text-align:center; margin-top:16px; color:var(--muted); font-size:14px; line-height:1.9 }
  .contacts{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-top:6px }
  .tag{ padding:6px 12px; border-radius:999px; border:1px solid rgba(255,255,255,.22);
        background:rgba(255,255,255,.06); color:#fff; font-weight:700 }

  .note{margin-top:10px; text-align:center; color:#cfe8ff; font-size:12px; opacity:.9}

  .dim{opacity:.7} .ok{color:#9fffcf} .bad{color:#ffb3b3}

  @media (max-width:700px){
    .grid{ grid-template-columns: 1fr }
    .label{ border-bottom:none }
    .value{ border-top:1px solid rgba(255,255,255,.06) }
  }
</style>
</head>
<body>
<!-- animated background -->
<div class="scene" aria-hidden="true">
  <div class="orb o1"></div>
  <div class="orb o2"></div>
  <div class="ring"></div>
  <div class="chip"></div>
</div>

<div class="wrap">
  <div class="card" role="region" aria-label="Thank you summary">
    <div class="edge"></div>

    <header class="header">
      <img class="logo" src="https://drive.google.com/uc?id=1RMiZhmDaciD0QDxIMMrHRTYXHP5UK5Pl" alt="Alhijrah Logo" />
      <h1 class="title">تم استلام طلبك بنجاح ✅</h1>
      <p class="subtitle">Career Gate – Alhijrah Services</p>
      <p class="lead">
        شكرًا لتعبئة نموذج التوظيف. فريقنا سيتواصل معك قريبًا لاستكمال الإجراءات.
        <br/>Thank you for your submission. Our team will contact you shortly.
      </p>
    </header>

    <!-- dynamic status + case -->
    <p class="status">
      Application Status | حالة الطلب:
      <span id="status" class="pill">Received</span>
    </p>
    <p class="case">
      Case Number:
      <span id="caseNumber" class="pill">Career-XXXXXX</span>
    </p>

    <!-- summary -->
    <section class="grid" aria-label="Submission Summary">
      <div class="row"><div class="label">Full Name | الاسم الكامل</div><div id="fullName" class="value">—</div></div>
      <div class="row"><div class="label">Date of Birth | تاريخ الميلاد</div><div id="dob" class="value">—</div></div>
      <div class="row"><div class="label">Nationality | الجنسية</div><div id="nationality" class="value">—</div></div>
      <div class="row"><div class="label">Phone | الهاتف</div><div id="phone" class="value">—</div></div>
      <div class="row"><div class="label">Email | البريد الإلكتروني</div><div id="email" class="value">—</div></div>
      <div class="row"><div class="label">City | المدينة</div><div id="city" class="value">—</div></div>
      <div class="row"><div class="label">Professional Skills | المهارات</div><div id="skills" class="value">—</div></div>
    </section>

    <!-- actions -->
    <nav class="actions" role="group" aria-label="Actions">
      <a id="pdfBtn"  class="btn"      href="#" target="_blank" rel="noopener" style="display:none">تحميل PDF | Download PDF</a>
      <a id="editBtn" class="btn alt"  href="#" target="_blank" rel="noopener" style="display:none">تعديل الطلب | Edit Submission</a>
      <a id="trackBtn" class="btn ghost" href="#" target="_blank" rel="noopener">تتبّع طلبي | Track My Case</a>
      <a id="waBtn"    class="btn ghost" href="#" target="_blank" rel="noopener">إرسال عبر WhatsApp</a>
    </nav>

    <p id="syncNote" class="note dim">يتم تحديث الصفحة تلقائيًا عند توفر بيانات أحدث…</p>

    <footer class="footer">
      <div>تصميم ملكي أزرق وذهبي — تجربة رقمية شفافة، احترافية، وراقية.</div>
      <div class="contacts">
        <span class="tag">📞 +1 313-919-4292</span>
        <span class="tag">📧 jobs@alhijrahservices.com</span>
        <span class="tag">🌐 Alhijrahvisa.com</span>
      </div>
      <div style="margin-top:8px">
        Career Gate powered by <strong>Alhijrah Services</strong>
      </div>
    </footer>
  </div>
</div>

<!-- JS: reads URL params, renders, then (optionally) pulls freshest data from Apps Script -->
<script>
(function(){
  /* ====== CONFIG ====== */
  // If you want auto-sync with your Google Apps Script (prefer newest):
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyvP5-ZOleoCQSHvXXzp_3V4olSuVDTdloU0oyW1IsDzjMYCNwNISuYn31LOsN8hBCW6Q/exec"; // leave "" to disable
  const TRACK_BASE = "https://alhijrahvisa.com/track?case=";

  /* ====== Helpers ====== */
  const $ = id => document.getElementById(id);
  const set = (id, val, fallback='—') => { const el = $(id); if (el) el.textContent = (val && String(val).trim()) ? String(val).trim() : fallback; };
  const qp = new URLSearchParams(location.search);
  const pick = (...keys) => {
    for (const k of keys){ const v = qp.get(k); if (v && String(v).trim()) return String(v).trim(); }
    return "";
  };
  const normPhone = s => (s||"").replace(/[^\d+]/g,"");

  /* ====== Read from URL (Jotform redirect) ====== */
  const ui = pick("uniqueId","uniqueID","uid","case","caseNumber");
  const base = {
    caseNumber: ui,
    status:     pick("applicationStatus","status") || "Received",
    fullName:   pick("fullName4","fullName","name") || [pick("firstName","first"), pick("lastName","last")].filter(Boolean).join(" "),
    dob:        pick("input51","dob","dateOfBirth"),
    nationality:pick("input52","nationality"),
    phone:      normPhone(pick("input45","phone","tel","mobile")),
    email:      pick("email5","email"),
    city:       pick("address_city","address:city","city"),
    skills:     pick("input54","skills","professionalSkills"),
    pdf:        pick("pdf","pdf-link"),
    edit:       pick("edit","edit_link","editLink"),
    submissionId: pick("id","submissionID","sid")
  };

  // If your Unique ID must start with "Career-", fix it up:
  function normalizeCaseNumber(v){
    if(!v) return "";
    return /^career-/i.test(v) ? v.replace(/^career-/i,"Career-") : (/^\d{6}$/.test(v) ? "Career-"+v : v);
  }
  base.caseNumber = normalizeCaseNumber(base.caseNumber);

  /* ====== Render first (instant) ====== */
  set("status", base.status);
  set("caseNumber", base.caseNumber || (base.submissionId ? ("ALH-"+new Date().toISOString().slice(0,10).replace(/-/g,"")+"-"+base.submissionId) : ""));
  set("fullName", base.fullName);
  set("dob", base.dob);
  set("nationality", base.nationality);
  set("phone", base.phone);
  set("email", base.email);
  set("city", base.city);
  set("skills", base.skills);

  const trackHref = TRACK_BASE + encodeURIComponent(base.caseNumber || "");
  const pdfBtn = $("pdfBtn"), editBtn = $("editBtn"), trackBtn = $("trackBtn"), waBtn = $("waBtn");
  if (pdfBtn && base.pdf){ pdfBtn.href = base.pdf; pdfBtn.style.display = "inline-flex"; }
  if (editBtn && base.edit){ editBtn.href = base.edit; editBtn.style.display = "inline-flex"; }
  if (trackBtn){ trackBtn.href = trackHref; }
  if (waBtn){
    const lines = [
      "ALHIJRAH – Career Gate",
      `Case: ${base.caseNumber||"—"}`,
      `Status: ${base.status||"—"}`,
      `Name: ${base.fullName||"—"}`,
      `Phone: ${base.phone||"—"}`,
      `Email: ${base.email||"—"}`,
      `City: ${base.city||"—"}`
    ].join("\n");
    waBtn.href = "https://wa.me/13139194292?text=" + encodeURIComponent(lines);
  }

  /* ====== Prefer newest (optional server sync) ====== */
  async function trySync(){
    const note = $("syncNote");
    if(!SCRIPT_URL || !base.caseNumber){ if(note){ note.textContent = "تم العرض من بيانات الإرسال. (لا يوجد تزامن خادم)"; } return; }
    try{
      if(note){ note.innerHTML = '<span class="dim">جاري التحقق من أحدث البيانات…</span>'; }
      const url = `${SCRIPT_URL}?by=case&key=${encodeURIComponent(base.caseNumber)}`;
      const r = await fetch(url, {headers:{Accept:"application/json"}, cache:"no-store"});
      if(!r.ok) throw new Error("HTTP "+r.status);
      const d = await r.json();
      if(d && !d.error){
        // merge, preferring server fields if present
        const merged = {
          caseNumber: d.caseNumber || d.caseId || base.caseNumber,
          status: d.applicationStatus || d.status || base.status,
          fullName: d.fullName || [d.firstName,d.lastName].filter(Boolean).join(" ") || base.fullName,
          dob: d.dateOfBirth || d.dob || base.dob,
          nationality: d.nationality || base.nationality,
          phone: d.phone || base.phone,
          email: d.email || base.email,
          city: d.address?.city || d.city || base.city,
          skills: d.skills || d.professionalSkills || base.skills,
          pdf: base.pdf,  // keep URL params if provided
          edit: d.meta?.editUrl || base.edit
        };
        set("status", merged.status);
        set("caseNumber", merged.caseNumber);
        set("fullName", merged.fullName);
        set("dob", merged.dob);
        set("nationality", merged.nationality);
        set("phone", merged.phone);
        set("email", merged.email);
        set("city", merged.city);
        set("skills", merged.skills);

        if(editBtn && merged.edit){ editBtn.href = merged.edit; editBtn.style.display="inline-flex"; }
        if(trackBtn){ trackBtn.href = TRACK_BASE + encodeURIComponent(merged.caseNumber||""); }
        if(waBtn){
          const lines2 = [
            "ALHIJRAH – Career Gate",
            `Case: ${merged.caseNumber||"—"}`,
            `Status: ${merged.status||"—"}`,
            `Name: ${merged.fullName||"—"}`,
            `Phone: ${merged.phone||"—"}`,
            `Email: ${merged.email||"—"}`,
            `City: ${merged.city||"—"}`
          ].join("\n");
          waBtn.href = "https://wa.me/13139194292?text=" + encodeURIComponent(lines2);
        }
        if(note){ note.innerHTML = '<span class="ok">تمت مزامنة أحدث حالة تلقائيًا.</span>'; }
      }else{
        if(note){ note.innerHTML = '<span class="bad">تعذر جلب أحدث البيانات من الخادم.</span>'; }
      }
    }catch(e){
      const note = $("syncNote");
      if(note){ note.innerHTML = '<span class="bad">خطأ في الاتصال بالخادم.</span>'; }
      console.error(e);
    }
  }
  trySync();
})();
</script>

<!-- tiny English footer (optional) -->
<div style="direction:ltr; text-align:center; margin-top:12px; opacity:.55; font:12px/1.7 system-ui">
  Need help? Email <a href="mailto:jobs@alhijrahservices.com">jobs@alhijrahservices.com</a>
</div>
</body>
</html>
